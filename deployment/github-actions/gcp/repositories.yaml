VJftw/infrastructure:
  pull_requests:
    workspace_scopes: 
      # This doesn't actually set anything, but outputs the required 
      # configuration detail for configuring Google Workspace Domain Wide 
      # Delegation (https://developers.google.com/admin-sdk/directory/v1/guides/delegation#delegate_domain-wide_authority_to_your_service_account)
      - https://www.googleapis.com/auth/admin.directory.device.chromeos.readonly
      - https://www.googleapis.com/auth/admin.directory.device.mobile.readonly
      - https://www.googleapis.com/auth/admin.directory.group.member.readonly
      - https://www.googleapis.com/auth/admin.directory.group.readonly
      - https://www.googleapis.com/auth/admin.directory.orgunit.readonly
      - https://www.googleapis.com/auth/admin.directory.user.readonly
      - https://www.googleapis.com/auth/admin.directory.user.alias.readonly
      - https://www.googleapis.com/auth/admin.directory.rolemanagement.readonly
      - https://www.googleapis.com/auth/admin.directory.userschema.readonly
      - https://www.googleapis.com/auth/admin.directory.customer.readonly
      - https://www.googleapis.com/auth/admin.directory.domain.readonly
      - https://www.googleapis.com/auth/admin.directory.resource.calendar.readonly

    organization:
      - roles/billing.viewer
      - roles/iam.securityReviewer
      - roles/orgpolicy.policyViewer
      - roles/resourcemanager.folderViewer
      - roles/resourcemanager.organizationViewer
      - roles/viewer
    buckets:
      vjp-terraform-state: 
        - roles/storage.objectViewer
        - roles/storage.legacyBucketWriter
    billing_accounts:
      "My Billing Account":
        - roles/billing.viewer

  branches:
    main:
      workspace_scopes:
        # This doesn't actually set anything, but outputs the required 
        # configuration detail for configuring Google Workspace Domain Wide 
        # Delegation (https://developers.google.com/admin-sdk/directory/v1/guides/delegation#delegate_domain-wide_authority_to_your_service_account)
        - https://www.googleapis.com/auth/admin.directory.device.chromeos
        - https://www.googleapis.com/auth/admin.directory.device.mobile
        - https://www.googleapis.com/auth/admin.directory.group.member
        - https://www.googleapis.com/auth/admin.directory.group
        - https://www.googleapis.com/auth/admin.directory.orgunit
        - https://www.googleapis.com/auth/admin.directory.user
        - https://www.googleapis.com/auth/admin.directory.user.alias
        - https://www.googleapis.com/auth/admin.directory.user.security
        - https://www.googleapis.com/auth/admin.directory.rolemanagement
        - https://www.googleapis.com/auth/admin.directory.userschema
        - https://www.googleapis.com/auth/admin.directory.customer
        - https://www.googleapis.com/auth/admin.directory.domain
        - https://www.googleapis.com/auth/admin.directory.resource.calendar
        
      organization:
        - roles/billing.admin
        - roles/orgpolicy.policyAdmin
        - roles/owner
        - roles/resourcemanager.folderAdmin
        - roles/resourcemanager.folderIamAdmin
        - roles/resourcemanager.organizationAdmin
        - roles/resourcemanager.projectCreator
      buckets:
        vjp-terraform-state: 
          - roles/storage.objectAdmin
      billing_accounts:
        "My Billing Account":
          - roles/billing.user

VJftw/cloud-bastion:
  pull_requests:
    organization:
      - roles/billing.viewer
      - roles/iam.securityReviewer
      - roles/resourcemanager.folderViewer
      - roles/resourcemanager.organizationViewer
      - roles/viewer
    folders:
      sandbox:
        - roles/iam.securityReviewer
        - roles/owner # // allow Terratest in Sandbox only during PR
        - roles/resourcemanager.folderViewer
        - roles/resourcemanager.projectCreator
        - roles/resourcemanager.projectDeleter
    billing_accounts:
      "My Billing Account": # TODO: use a separate billing account for Sandbox?
        - roles/billing.user
    
  branches:
    main:
      organization:
        - roles/billing.viewer
        - roles/iam.securityReviewer
        - roles/resourcemanager.folderViewer
        - roles/resourcemanager.organizationViewer
        - roles/viewer
      folders:
        sandbox:
          - roles/owner
          - roles/resourcemanager.projectCreator
          - roles/resourcemanager.projectDeleter
      billing_accounts:
        "My Billing Account": 
          - roles/billing.user
  
VJftw/cloud-desktops:
  pull_requests:
    organization:
      - roles/billing.viewer
      - roles/resourcemanager.folderViewer
      - roles/resourcemanager.organizationViewer
    buckets:
      vjp-sandbox-terraform-state: 
        - roles/storage.objectAdmin
    projects:
      vjp-cloud-desktops-pr:
        - roles/compute.admin
        - roles/iap.tunnelResourceAccessor
    billing_accounts:
      "My Billing Account": # TODO: use a separate billing account for Sandbox?
        - roles/billing.viewer
    
  branches:
    main:
      organization:
        - roles/billing.viewer
        - roles/resourcemanager.folderViewer
        - roles/resourcemanager.organizationViewer
      buckets:
        vjp-terraform-state: 
          - roles/storage.objectAdmin
      projects:
        vjp-cloud-desktops-pr: # for cleanup
          - roles/compute.admin
        vjp-cloud-desktops:
          - roles/compute.admin
          - roles/iap.tunnelResourceAccessor
      billing_accounts:
        "My Billing Account": 
          - roles/billing.user


VJftw/remote-ws:
  pull_requests:
    buckets:
      vjp-terraform-state: 
        - roles/storage.objectAdmin
    projects:
      vjp-remote-ws:
        - roles/compute.viewer
      vjp-dns:
        - roles/dns.reader
    
  branches:
    main:
      buckets:
        vjp-terraform-state: 
          - roles/storage.objectAdmin
      projects:
        vjp-remote-ws:
          - roles/owner

        vjp-dns:
          - roles/dns.admin
          - roles/iam.securityAdmin

VJftw/vjpatel.me:
  pull_requests:
    buckets:
      vjp-terraform-state: 
        - roles/storage.objectAdmin
  branches:
    main:
      buckets:
        vjp-terraform-state: 
          - roles/storage.objectAdmin
